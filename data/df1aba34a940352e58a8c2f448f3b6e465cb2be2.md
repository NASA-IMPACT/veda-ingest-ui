# Test info

- Name: COG Viewer Drawer >> COG Viewer loads with renders object presets
- Location: /home/runner/work/veda-ingest-ui/veda-ingest-ui/__tests__/playwright/COGViewerDrawer.test.tsx:5:7

# Error details

```
Error: locator.click: Test timeout of 60000ms exceeded.
Call log:
  - waiting for getByRole('button', { name: /Generate Renders Object from Sample File/i })

    at /home/runner/work/veda-ingest-ui/veda-ingest-ui/__tests__/playwright/COGViewerDrawer.test.tsx:47:10
    at /home/runner/work/veda-ingest-ui/veda-ingest-ui/__tests__/playwright/COGViewerDrawer.test.tsx:42:16
```

# Page snapshot

```yaml
- complementary:
  - text: VEDA Ingest UI
  - menu:
    - menuitem "home Home":
      - img "home"
      - link "Home":
        - /url: /
    - link "Collections":
      - /url: /collections
    - group:
      - menuitem "plus-circle Create Collection":
        - img "plus-circle"
        - link "Create Collection":
          - /url: /create-collection
    - link "Datasets":
      - /url: /datasets
    - group:
      - menuitem "plus-circle Create Dataset":
        - img "plus-circle"
        - link "Create Dataset":
          - /url: /create-dataset
    - text: Tools
    - group:
      - menuitem "global COG Viewer":
        - img "global"
        - link "COG Viewer":
          - /url: /cog-viewer
      - menuitem "cloud-upload Thumbnail Uploader":
        - img "cloud-upload"
        - link "Thumbnail Uploader":
          - /url: /upload
  - button "logout Sign out":
    - img "logout"
    - text: Sign out
  - img "left"
- main:
  - heading "Create New Dataset" [level=2]
  - tablist:
    - tab "Form" [selected]
    - tab "Manual JSON Edit"
  - tabpanel "Form":
    - group:
      - text: "* Collection"
      - textbox "* Collection"
      - text: "* Title"
      - textbox "* Title"
      - text: "* License"
      - textbox "* License": CC0-1.0
      - checkbox "Is Periodic?"
      - text: Is Periodic? Time Density
      - textbox "Time Density"
      - text: "* Data Type"
      - textbox "* Data Type": cog
      - text: STAC Version
      - textbox "STAC Version": 1.0.0
      - text: "* Description"
      - textbox "* Description"
      - group:
        - text: "* Spatial Extent xmin"
        - button "Increase Value":
          - img "up"
        - button "Decrease Value":
          - img "down"
        - spinbutton "xmin": "-180"
        - text: ymin
        - button "Increase Value":
          - img "up"
        - button "Decrease Value":
          - img "down"
        - spinbutton "ymin": "-90"
        - text: xmax
        - button "Increase Value":
          - img "up"
        - button "Decrease Value":
          - img "down"
        - spinbutton "xmax": "180"
        - text: ymax
        - button "Increase Value":
          - img "up"
        - button "Decrease Value":
          - img "down"
        - spinbutton "ymax": "90"
      - group:
        - text: "* Temporal Extent Start Date"
        - textbox "Start Date": 2025-06-27T00:00:00.000Z
        - text: End Date
        - textbox "End Date": 2025-06-27T23:59:59.000Z
      - group:
        - text: "* Discovery Items Discovery"
        - combobox "Discovery"
        - text: "* Prefix"
        - textbox "* Prefix"
        - text: "* Bucket"
        - textbox "* Bucket"
        - text: Filename Regex
        - textbox "Filename Regex": "[\\s\\S]*"
        - button "collapsed More Options":
          - img "collapsed"
          - text: More Options
        - button "delete":
          - img "delete"
        - button "plus-circle":
          - img "plus-circle"
      - group:
        - text: "* Sample Files * Sample Files-1"
        - textbox "* Sample Files-1": s3://test.com
        - button "delete":
          - img "delete"
        - button "plus-circle":
          - img "plus-circle"
      - group:
        - text: "* Renders * Dashboard"
        - textbox: "{ \"resampling\": \"nearest\", \"bidx\": [ 1 ], \"colormap_name\": \"rdbu\", \"assets\": [ \"cog_default\" ], \"rescale\": [ [ -1, 1 ] ], \"color_formula\": \"test123\", \"nodata\": 255, \"title\": \"VEDA Dashboard Render Parameters\" }"
        - button "import Generate Renders Object From Sample File":
          - img "import"
          - text: Generate Renders Object From Sample File
      - group:
        - text: STAC Extensions * STAC Extensions-1
        - textbox "* STAC Extensions-1": https://stac-extensions.github.io/render/v1.0.0/schema.json
        - button "arrow-up" [disabled]:
          - img "arrow-up"
        - button "arrow-down":
          - img "arrow-down"
        - button "delete":
          - img "delete"
        - text: "* STAC Extensions-2"
        - textbox "* STAC Extensions-2": https://stac-extensions.github.io/item-assets/v1.0.0/schema.json
        - button "arrow-up":
          - img "arrow-up"
        - button "arrow-down" [disabled]:
          - img "arrow-down"
        - button "delete":
          - img "delete"
        - button "plus-circle":
          - img "plus-circle"
      - group:
        - text: Links
        - button "plus-circle":
          - img "plus-circle"
      - group:
        - text: "* Item Assets"
        - group:
          - text: "* cog_default * title"
          - textbox "* title": Default COG Layer
          - text: "* type"
          - textbox "* type": image/tiff; application=geotiff; profile=cloud-optimized
          - text: "* description"
          - textbox "* description": Cloud optimized default layer to display on map
          - group:
            - text: "* roles * roles-1"
            - textbox "* roles-1": data
            - button "arrow-up" [disabled]:
              - img "arrow-up"
            - button "arrow-down":
              - img "arrow-down"
            - button "delete":
              - img "delete"
            - text: "* roles-2"
            - textbox "* roles-2": layer
            - button "arrow-up":
              - img "arrow-up"
            - button "arrow-down" [disabled]:
              - img "arrow-down"
            - button "delete":
              - img "delete"
            - button "plus-circle":
              - img "plus-circle"
      - group:
        - text: "* Providers"
        - group:
          - text: "* Providers-1 * Organization name"
          - textbox "* Organization name": NASA VEDA
          - text: Organization description
          - textbox "Organization description"
          - group:
            - text: Organization roles * Organization roles-1
            - combobox "* Organization roles-1"
            - text: host
            - button "delete":
              - img "delete"
            - button "plus-circle":
              - img "plus-circle"
          - text: Organization homepage
          - textbox "Organization homepage": https://www.earthdata.nasa.gov/dashboard/
        - button "delete":
          - img "delete"
        - button "plus-circle":
          - img "plus-circle"
      - group:
        - text: Assets
        - group:
          - text: Thumbnail * title
          - textbox "* title": Thumbnail
          - text: "* href"
          - textbox "* href"
          - text: "* type"
          - textbox "* type": image/jpeg
          - text: "* description"
          - textbox "* description"
          - group:
            - text: "* roles * roles-1"
            - textbox "* roles-1": thumbnail
            - button "delete":
              - img "delete"
            - button "plus-circle":
              - img "plus-circle"
    - button "Submit"
- button "Open Next.js Dev Tools":
  - img
- button "Open issues overlay": 2 Issue
- button "Collapse issues badge":
  - img
- alert
```

# Test source

```ts
   1 | import { expect, test } from '@/__tests__/playwright/setup-msw';
   2 | import { HttpResponse } from 'msw';
   3 |
   4 | test.describe('COG Viewer Drawer', () => {
   5 |   test('COG Viewer loads with renders object presets', async ({
   6 |     page,
   7 |   }, testInfo) => {
   8 |     await test.step('navigate to Create Dataset page', async () => {
   9 |       await page.goto('/create-dataset');
   10 |     });
   11 |
   12 |     await test.step('enter URL of Sample File and valid json in renders object', async () => {
   13 |       await page.getByLabel('Sample Files-1').fill('s3://test.com');
   14 |
   15 |       await page
   16 |         .locator('#root_renders')
   17 |         .getByRole('textbox')
   18 |         .fill(
   19 |           JSON.stringify(
   20 |             {
   21 |               resampling: 'nearest',
   22 |               bidx: [1],
   23 |               colormap_name: 'rdbu',
   24 |               assets: ['cog_default'],
   25 |               rescale: [[-1, 1]],
   26 |               color_formula: 'test123',
   27 |               nodata: 255,
   28 |               title: 'VEDA Dashboard Render Parameters',
   29 |             },
   30 |             null,
   31 |             2
   32 |           )
   33 |         );
   34 |     });
   35 |
   36 |     const initialRendersScreenshot = await page.screenshot({ fullPage: true });
   37 |     testInfo.attach('Initial Renders Object', {
   38 |       body: initialRendersScreenshot,
   39 |       contentType: 'image/png',
   40 |     });
   41 |
   42 |     await test.step('click button to open COG Viewer Drawer', async () => {
   43 |       await page
   44 |         .getByRole('button', {
   45 |           name: /Generate Renders Object from Sample File/i,
   46 |         })
>  47 |         .click();
      |          ^ Error: locator.click: Test timeout of 60000ms exceeded.
   48 |     });
   49 |
   50 |     await expect(
   51 |       page.getByText('Band: Band 1 (Index: 1)'),
   52 |       'multi-band COGs should not have Band Name Header'
   53 |     ).toBeHidden();
   54 |     await test.step('validate that RGB Band Dropdowns are visible and populated with first 3 bands', async () => {
   55 |       await expect(page.getByLabel('Band (R)')).toBeVisible();
   56 |       await expect(page.locator('[data-testid="band-R"]')).toContainText(
   57 |         'b1 - Band 1'
   58 |       );
   59 |       await expect(page.getByLabel('Band (G)')).toBeVisible();
   60 |       await expect(page.locator('[data-testid="band-G"]')).toContainText(
   61 |         'b2 - Band 2'
   62 |       );
   63 |       await expect(page.getByLabel('Band (B)')).toBeVisible();
   64 |       await expect(page.locator('[data-testid="band-B"]')).toContainText(
   65 |         'b3 - Band 3'
   66 |       );
   67 |     });
   68 |
   69 |     await test.step('validate that form controls pre-populate with values from renders object', async () => {
   70 |       await expect(page.locator('[data-testid="colormap"]')).toContainText(
   71 |         'rdbu'
   72 |       );
   73 |       await expect(page.locator('[data-testid="resampling"]')).toContainText(
   74 |         /nearest/i
   75 |       );
   76 |
   77 |       await expect(page.locator('[data-testid="colorFormula"]')).toHaveValue(
   78 |         /test123/i
   79 |       );
   80 |
   81 |       await expect(page.locator('[data-testid="nodata"]')).toHaveValue(/255/i);
   82 |     });
   83 |
   84 |     const prepopulatedControlsScreenshot = await page.screenshot();
   85 |     testInfo.attach('Pre-populated COG Viewer Form Controls', {
   86 |       body: prepopulatedControlsScreenshot,
   87 |       contentType: 'image/png',
   88 |     });
   89 |
   90 |     await test.step('validate that Rendering Options Modal displays values in form in pretty json format', async () => {
   91 |       await page
   92 |         .getByRole('button', { name: 'View Rendering Options' })
   93 |         .click();
   94 |       await expect(
   95 |         page.getByRole('dialog', { name: /COG Rendering Options/i })
   96 |       ).toBeVisible();
   97 |       await expect(
   98 |         page.getByText('COG Rendering Options{ "bidx').getByRole('textbox')
   99 |       ).toHaveText(
  100 |         JSON.stringify(
  101 |           {
  102 |             bidx: [1],
  103 |             rescale: [[-1, 1]],
  104 |             colormap_name: 'rdbu',
  105 |             color_formula: 'test123',
  106 |             resampling: 'nearest',
  107 |             nodata: 255,
  108 |             assets: ['cog_default'],
  109 |           },
  110 |           null,
  111 |           2
  112 |         )
  113 |       );
  114 |     });
  115 |
  116 |     const renderingOptionsModalScreenshot = await page.screenshot();
  117 |     testInfo.attach('Rendering Options Modal', {
  118 |       body: renderingOptionsModalScreenshot,
  119 |       contentType: 'image/png',
  120 |     });
  121 |   });
  122 |
  123 |   test('COG Viewer loads without entry in renders object', async ({
  124 |     page,
  125 |   }, testInfo) => {
  126 |     await test.step('navigate to Create Dataset page', async () => {
  127 |       await page.goto('/create-dataset');
  128 |     });
  129 |
  130 |     await test.step('enter URL of Sample File but no renders object', async () => {
  131 |       await page.getByLabel('Sample Files-1').fill('s3://test.com');
  132 |     });
  133 |
  134 |     await test.step('click button to open COG Viewer Drawer', async () => {
  135 |       await page
  136 |         .getByRole('button', {
  137 |           name: /Generate Renders Object from Sample File/i,
  138 |         })
  139 |         .click();
  140 |     });
  141 |
  142 |     await test.step('validate that form controls pre-populate with default values', async () => {
  143 |       await expect(page.locator('[data-testid="colormap"]')).toContainText(
  144 |         'Internal'
  145 |       );
  146 |       await expect(page.locator('[data-testid="resampling"]')).toContainText(
  147 |         ''
```